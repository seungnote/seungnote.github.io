---
title:  "[Python] 데이터전처리-결측치 이상치 제거" 

categories:
  - python
tags:
  - [Python,ADP,class101]

toc: true
toc_sticky: true

date: 2022-12-06

---

# 결측치, 이상치 처리하기

## 결측치 인식 isnull
* dataframe.isna() <br>
데이터의 요소가 결측치일 경우 TRUEisna().sum()=1 반환하고, 그렇지 않을 경우 FALSE 반환  <br>
<b>.isna() = .isnull()</b>
* 변수별로 데이터의 각 행에 결측치가 있는지 확인 후 반환
* 합을 구해 결측치의 개수를 쉽게 파악 가능


```python
import pandas as pd
import numpy as np
```


```python
air=pd.read_csv('D:/anaconda/00.studying/data/airquality.csv')
air.head(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ozone</th>
      <th>Solar.R</th>
      <th>Wind</th>
      <th>Temp</th>
      <th>Month</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>41.0</td>
      <td>190.0</td>
      <td>7.4</td>
      <td>67</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36.0</td>
      <td>118.0</td>
      <td>8.0</td>
      <td>72</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12.0</td>
      <td>149.0</td>
      <td>12.6</td>
      <td>74</td>
      <td>5</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




```python
air.info()

# 153 entries Ozone    116 non-null
# 153-116=37개의 NULL값이 있다는걸 알수있음 
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 153 entries, 0 to 152
    Data columns (total 6 columns):
     #   Column   Non-Null Count  Dtype  
    ---  ------   --------------  -----  
     0   Ozone    116 non-null    float64
     1   Solar.R  146 non-null    float64
     2   Wind     153 non-null    float64
     3   Temp     153 non-null    int64  
     4   Month    153 non-null    int64  
     5   Day      153 non-null    int64  
    dtypes: float64(3), int64(3)
    memory usage: 7.3 KB
    


```python
air.isnull().sum()
```




    Ozone      37
    Solar.R     7
    Wind        0
    Temp        0
    Month       0
    Day         0
    dtype: int64




```python
air['Ozone'].isna()
```




    0      False
    1      False
    2      False
    3      False
    4       True
           ...  
    148    False
    149     True
    150    False
    151    False
    152    False
    Name: Ozone, Length: 153, dtype: bool




```python
# Ozone값이 NaN인 값만 추출 
air[air['Ozone'].isna()]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ozone</th>
      <th>Solar.R</th>
      <th>Wind</th>
      <th>Temp</th>
      <th>Month</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.3</td>
      <td>56</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NaN</td>
      <td>194.0</td>
      <td>8.6</td>
      <td>69</td>
      <td>5</td>
      <td>10</td>
    </tr>
    <tr>
      <th>24</th>
      <td>NaN</td>
      <td>66.0</td>
      <td>16.6</td>
      <td>57</td>
      <td>5</td>
      <td>25</td>
    </tr>
    <tr>
      <th>25</th>
      <td>NaN</td>
      <td>266.0</td>
      <td>14.9</td>
      <td>58</td>
      <td>5</td>
      <td>26</td>
    </tr>
    <tr>
      <th>26</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.0</td>
      <td>57</td>
      <td>5</td>
      <td>27</td>
    </tr>
    <tr>
      <th>31</th>
      <td>NaN</td>
      <td>286.0</td>
      <td>8.6</td>
      <td>78</td>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>32</th>
      <td>NaN</td>
      <td>287.0</td>
      <td>9.7</td>
      <td>74</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>33</th>
      <td>NaN</td>
      <td>242.0</td>
      <td>16.1</td>
      <td>67</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>34</th>
      <td>NaN</td>
      <td>186.0</td>
      <td>9.2</td>
      <td>84</td>
      <td>6</td>
      <td>4</td>
    </tr>
    <tr>
      <th>35</th>
      <td>NaN</td>
      <td>220.0</td>
      <td>8.6</td>
      <td>85</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>36</th>
      <td>NaN</td>
      <td>264.0</td>
      <td>14.3</td>
      <td>79</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>38</th>
      <td>NaN</td>
      <td>273.0</td>
      <td>6.9</td>
      <td>87</td>
      <td>6</td>
      <td>8</td>
    </tr>
    <tr>
      <th>41</th>
      <td>NaN</td>
      <td>259.0</td>
      <td>10.9</td>
      <td>93</td>
      <td>6</td>
      <td>11</td>
    </tr>
    <tr>
      <th>42</th>
      <td>NaN</td>
      <td>250.0</td>
      <td>9.2</td>
      <td>92</td>
      <td>6</td>
      <td>12</td>
    </tr>
    <tr>
      <th>44</th>
      <td>NaN</td>
      <td>332.0</td>
      <td>13.8</td>
      <td>80</td>
      <td>6</td>
      <td>14</td>
    </tr>
    <tr>
      <th>45</th>
      <td>NaN</td>
      <td>322.0</td>
      <td>11.5</td>
      <td>79</td>
      <td>6</td>
      <td>15</td>
    </tr>
    <tr>
      <th>51</th>
      <td>NaN</td>
      <td>150.0</td>
      <td>6.3</td>
      <td>77</td>
      <td>6</td>
      <td>21</td>
    </tr>
    <tr>
      <th>52</th>
      <td>NaN</td>
      <td>59.0</td>
      <td>1.7</td>
      <td>76</td>
      <td>6</td>
      <td>22</td>
    </tr>
    <tr>
      <th>53</th>
      <td>NaN</td>
      <td>91.0</td>
      <td>4.6</td>
      <td>76</td>
      <td>6</td>
      <td>23</td>
    </tr>
    <tr>
      <th>54</th>
      <td>NaN</td>
      <td>250.0</td>
      <td>6.3</td>
      <td>76</td>
      <td>6</td>
      <td>24</td>
    </tr>
    <tr>
      <th>55</th>
      <td>NaN</td>
      <td>135.0</td>
      <td>8.0</td>
      <td>75</td>
      <td>6</td>
      <td>25</td>
    </tr>
    <tr>
      <th>56</th>
      <td>NaN</td>
      <td>127.0</td>
      <td>8.0</td>
      <td>78</td>
      <td>6</td>
      <td>26</td>
    </tr>
    <tr>
      <th>57</th>
      <td>NaN</td>
      <td>47.0</td>
      <td>10.3</td>
      <td>73</td>
      <td>6</td>
      <td>27</td>
    </tr>
    <tr>
      <th>58</th>
      <td>NaN</td>
      <td>98.0</td>
      <td>11.5</td>
      <td>80</td>
      <td>6</td>
      <td>28</td>
    </tr>
    <tr>
      <th>59</th>
      <td>NaN</td>
      <td>31.0</td>
      <td>14.9</td>
      <td>77</td>
      <td>6</td>
      <td>29</td>
    </tr>
    <tr>
      <th>60</th>
      <td>NaN</td>
      <td>138.0</td>
      <td>8.0</td>
      <td>83</td>
      <td>6</td>
      <td>30</td>
    </tr>
    <tr>
      <th>64</th>
      <td>NaN</td>
      <td>101.0</td>
      <td>10.9</td>
      <td>84</td>
      <td>7</td>
      <td>4</td>
    </tr>
    <tr>
      <th>71</th>
      <td>NaN</td>
      <td>139.0</td>
      <td>8.6</td>
      <td>82</td>
      <td>7</td>
      <td>11</td>
    </tr>
    <tr>
      <th>74</th>
      <td>NaN</td>
      <td>291.0</td>
      <td>14.9</td>
      <td>91</td>
      <td>7</td>
      <td>14</td>
    </tr>
    <tr>
      <th>82</th>
      <td>NaN</td>
      <td>258.0</td>
      <td>9.7</td>
      <td>81</td>
      <td>7</td>
      <td>22</td>
    </tr>
    <tr>
      <th>83</th>
      <td>NaN</td>
      <td>295.0</td>
      <td>11.5</td>
      <td>82</td>
      <td>7</td>
      <td>23</td>
    </tr>
    <tr>
      <th>101</th>
      <td>NaN</td>
      <td>222.0</td>
      <td>8.6</td>
      <td>92</td>
      <td>8</td>
      <td>10</td>
    </tr>
    <tr>
      <th>102</th>
      <td>NaN</td>
      <td>137.0</td>
      <td>11.5</td>
      <td>86</td>
      <td>8</td>
      <td>11</td>
    </tr>
    <tr>
      <th>106</th>
      <td>NaN</td>
      <td>64.0</td>
      <td>11.5</td>
      <td>79</td>
      <td>8</td>
      <td>15</td>
    </tr>
    <tr>
      <th>114</th>
      <td>NaN</td>
      <td>255.0</td>
      <td>12.6</td>
      <td>75</td>
      <td>8</td>
      <td>23</td>
    </tr>
    <tr>
      <th>118</th>
      <td>NaN</td>
      <td>153.0</td>
      <td>5.7</td>
      <td>88</td>
      <td>8</td>
      <td>27</td>
    </tr>
    <tr>
      <th>149</th>
      <td>NaN</td>
      <td>145.0</td>
      <td>13.2</td>
      <td>77</td>
      <td>9</td>
      <td>27</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Ozone변수에서 na가 아닌 값과 na 값의 개수 비교
air['Ozone'].isna().value_counts()
```




    False    116
    True      37
    Name: Ozone, dtype: int64



## 결측치 하나라도 존재하는 행들 불러오기

결측치가 있는/없는 행 확인<br>
* na가 있는 행들 저장 : df_row_with_na = df[df.isna().any(axis=1)]
* na가 없는 행들 저장 : df_row_without_na = df.dropna()


```python
air
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ozone</th>
      <th>Solar.R</th>
      <th>Wind</th>
      <th>Temp</th>
      <th>Month</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>41.0</td>
      <td>190.0</td>
      <td>7.4</td>
      <td>67</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36.0</td>
      <td>118.0</td>
      <td>8.0</td>
      <td>72</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12.0</td>
      <td>149.0</td>
      <td>12.6</td>
      <td>74</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18.0</td>
      <td>313.0</td>
      <td>11.5</td>
      <td>62</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.3</td>
      <td>56</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>148</th>
      <td>30.0</td>
      <td>193.0</td>
      <td>6.9</td>
      <td>70</td>
      <td>9</td>
      <td>26</td>
    </tr>
    <tr>
      <th>149</th>
      <td>NaN</td>
      <td>145.0</td>
      <td>13.2</td>
      <td>77</td>
      <td>9</td>
      <td>27</td>
    </tr>
    <tr>
      <th>150</th>
      <td>14.0</td>
      <td>191.0</td>
      <td>14.3</td>
      <td>75</td>
      <td>9</td>
      <td>28</td>
    </tr>
    <tr>
      <th>151</th>
      <td>18.0</td>
      <td>131.0</td>
      <td>8.0</td>
      <td>76</td>
      <td>9</td>
      <td>29</td>
    </tr>
    <tr>
      <th>152</th>
      <td>20.0</td>
      <td>223.0</td>
      <td>11.5</td>
      <td>68</td>
      <td>9</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
<p>153 rows × 6 columns</p>
</div>




```python
## 컬럼중에 하나라도 NULL값이 있으면 가져오기
air.isna().any(axis=1)
```


```python
air[air.isna().any(axis=1)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ozone</th>
      <th>Solar.R</th>
      <th>Wind</th>
      <th>Temp</th>
      <th>Month</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.3</td>
      <td>56</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>28.0</td>
      <td>NaN</td>
      <td>14.9</td>
      <td>66</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NaN</td>
      <td>194.0</td>
      <td>8.6</td>
      <td>69</td>
      <td>5</td>
      <td>10</td>
    </tr>
    <tr>
      <th>10</th>
      <td>7.0</td>
      <td>NaN</td>
      <td>6.9</td>
      <td>74</td>
      <td>5</td>
      <td>11</td>
    </tr>
    <tr>
      <th>24</th>
      <td>NaN</td>
      <td>66.0</td>
      <td>16.6</td>
      <td>57</td>
      <td>5</td>
      <td>25</td>
    </tr>
    <tr>
      <th>25</th>
      <td>NaN</td>
      <td>266.0</td>
      <td>14.9</td>
      <td>58</td>
      <td>5</td>
      <td>26</td>
    </tr>
    <tr>
      <th>26</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.0</td>
      <td>57</td>
      <td>5</td>
      <td>27</td>
    </tr>
    <tr>
      <th>31</th>
      <td>NaN</td>
      <td>286.0</td>
      <td>8.6</td>
      <td>78</td>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>32</th>
      <td>NaN</td>
      <td>287.0</td>
      <td>9.7</td>
      <td>74</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>33</th>
      <td>NaN</td>
      <td>242.0</td>
      <td>16.1</td>
      <td>67</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>34</th>
      <td>NaN</td>
      <td>186.0</td>
      <td>9.2</td>
      <td>84</td>
      <td>6</td>
      <td>4</td>
    </tr>
    <tr>
      <th>35</th>
      <td>NaN</td>
      <td>220.0</td>
      <td>8.6</td>
      <td>85</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>36</th>
      <td>NaN</td>
      <td>264.0</td>
      <td>14.3</td>
      <td>79</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>38</th>
      <td>NaN</td>
      <td>273.0</td>
      <td>6.9</td>
      <td>87</td>
      <td>6</td>
      <td>8</td>
    </tr>
    <tr>
      <th>41</th>
      <td>NaN</td>
      <td>259.0</td>
      <td>10.9</td>
      <td>93</td>
      <td>6</td>
      <td>11</td>
    </tr>
    <tr>
      <th>42</th>
      <td>NaN</td>
      <td>250.0</td>
      <td>9.2</td>
      <td>92</td>
      <td>6</td>
      <td>12</td>
    </tr>
    <tr>
      <th>44</th>
      <td>NaN</td>
      <td>332.0</td>
      <td>13.8</td>
      <td>80</td>
      <td>6</td>
      <td>14</td>
    </tr>
    <tr>
      <th>45</th>
      <td>NaN</td>
      <td>322.0</td>
      <td>11.5</td>
      <td>79</td>
      <td>6</td>
      <td>15</td>
    </tr>
    <tr>
      <th>51</th>
      <td>NaN</td>
      <td>150.0</td>
      <td>6.3</td>
      <td>77</td>
      <td>6</td>
      <td>21</td>
    </tr>
    <tr>
      <th>52</th>
      <td>NaN</td>
      <td>59.0</td>
      <td>1.7</td>
      <td>76</td>
      <td>6</td>
      <td>22</td>
    </tr>
    <tr>
      <th>53</th>
      <td>NaN</td>
      <td>91.0</td>
      <td>4.6</td>
      <td>76</td>
      <td>6</td>
      <td>23</td>
    </tr>
    <tr>
      <th>54</th>
      <td>NaN</td>
      <td>250.0</td>
      <td>6.3</td>
      <td>76</td>
      <td>6</td>
      <td>24</td>
    </tr>
    <tr>
      <th>55</th>
      <td>NaN</td>
      <td>135.0</td>
      <td>8.0</td>
      <td>75</td>
      <td>6</td>
      <td>25</td>
    </tr>
    <tr>
      <th>56</th>
      <td>NaN</td>
      <td>127.0</td>
      <td>8.0</td>
      <td>78</td>
      <td>6</td>
      <td>26</td>
    </tr>
    <tr>
      <th>57</th>
      <td>NaN</td>
      <td>47.0</td>
      <td>10.3</td>
      <td>73</td>
      <td>6</td>
      <td>27</td>
    </tr>
    <tr>
      <th>58</th>
      <td>NaN</td>
      <td>98.0</td>
      <td>11.5</td>
      <td>80</td>
      <td>6</td>
      <td>28</td>
    </tr>
    <tr>
      <th>59</th>
      <td>NaN</td>
      <td>31.0</td>
      <td>14.9</td>
      <td>77</td>
      <td>6</td>
      <td>29</td>
    </tr>
    <tr>
      <th>60</th>
      <td>NaN</td>
      <td>138.0</td>
      <td>8.0</td>
      <td>83</td>
      <td>6</td>
      <td>30</td>
    </tr>
    <tr>
      <th>64</th>
      <td>NaN</td>
      <td>101.0</td>
      <td>10.9</td>
      <td>84</td>
      <td>7</td>
      <td>4</td>
    </tr>
    <tr>
      <th>71</th>
      <td>NaN</td>
      <td>139.0</td>
      <td>8.6</td>
      <td>82</td>
      <td>7</td>
      <td>11</td>
    </tr>
    <tr>
      <th>74</th>
      <td>NaN</td>
      <td>291.0</td>
      <td>14.9</td>
      <td>91</td>
      <td>7</td>
      <td>14</td>
    </tr>
    <tr>
      <th>82</th>
      <td>NaN</td>
      <td>258.0</td>
      <td>9.7</td>
      <td>81</td>
      <td>7</td>
      <td>22</td>
    </tr>
    <tr>
      <th>83</th>
      <td>NaN</td>
      <td>295.0</td>
      <td>11.5</td>
      <td>82</td>
      <td>7</td>
      <td>23</td>
    </tr>
    <tr>
      <th>95</th>
      <td>78.0</td>
      <td>NaN</td>
      <td>6.9</td>
      <td>86</td>
      <td>8</td>
      <td>4</td>
    </tr>
    <tr>
      <th>96</th>
      <td>35.0</td>
      <td>NaN</td>
      <td>7.4</td>
      <td>85</td>
      <td>8</td>
      <td>5</td>
    </tr>
    <tr>
      <th>97</th>
      <td>66.0</td>
      <td>NaN</td>
      <td>4.6</td>
      <td>87</td>
      <td>8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>101</th>
      <td>NaN</td>
      <td>222.0</td>
      <td>8.6</td>
      <td>92</td>
      <td>8</td>
      <td>10</td>
    </tr>
    <tr>
      <th>102</th>
      <td>NaN</td>
      <td>137.0</td>
      <td>11.5</td>
      <td>86</td>
      <td>8</td>
      <td>11</td>
    </tr>
    <tr>
      <th>106</th>
      <td>NaN</td>
      <td>64.0</td>
      <td>11.5</td>
      <td>79</td>
      <td>8</td>
      <td>15</td>
    </tr>
    <tr>
      <th>114</th>
      <td>NaN</td>
      <td>255.0</td>
      <td>12.6</td>
      <td>75</td>
      <td>8</td>
      <td>23</td>
    </tr>
    <tr>
      <th>118</th>
      <td>NaN</td>
      <td>153.0</td>
      <td>5.7</td>
      <td>88</td>
      <td>8</td>
      <td>27</td>
    </tr>
    <tr>
      <th>149</th>
      <td>NaN</td>
      <td>145.0</td>
      <td>13.2</td>
      <td>77</td>
      <td>9</td>
      <td>27</td>
    </tr>
  </tbody>
</table>
</div>




```python
len(air[air.isna().any(axis=1)])
```




    42



## 결측치 삭제하기 dropna()

->근데 하면 위험할수있음 


```python
air_com=air.dropna()
air_com.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ozone</th>
      <th>Solar.R</th>
      <th>Wind</th>
      <th>Temp</th>
      <th>Month</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>41.0</td>
      <td>190.0</td>
      <td>7.4</td>
      <td>67</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36.0</td>
      <td>118.0</td>
      <td>8.0</td>
      <td>72</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12.0</td>
      <td>149.0</td>
      <td>12.6</td>
      <td>74</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18.0</td>
      <td>313.0</td>
      <td>11.5</td>
      <td>62</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>23.0</td>
      <td>299.0</td>
      <td>8.6</td>
      <td>65</td>
      <td>5</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>



##  결측치 대치법 이해
<b>가.</b> 단순 대치법
* complete analysis : 결측값이 존재하는 행 삭제
* 평균 대치법 : 관측 또는 실험을 통해 얻어진 데이터의 평균으로 결측치 대치
* 단순확률 대치법 : Hot-deck 방법, nearest neighbor 방법 등
    
<b>나.</b> 다중 대치법
* 단순 대치법을 m번 수행해 m개의 가상적 완전 자료를 만듦
* [대치] - [분석] - [결합] 단계

### 결측치 제거
* 결측치가 존재하는 행/열 제거
   
<div style="font-weight: bold; font-size: 120%; margin-left:30px"> 
    <table align="left" margin:50 font-size: 120%>
        <tr>
            <td style="text-align: left;">데이터명.dropna()</td>
            <td style="text-align: left;">행 기준으로 결측치가 있는 행은 모두 삭제</td>
        </tr>
        <tr>
            <td style="text-align: left;">데이터명.dropna(axis=1)</td>
            <td style="text-align: left;">열 기준으로 결측치가 있는 열은 모두 삭제</td>
        </tr>
        <tr>
            <td style="text-align: left;">데이터명.dropna(how='all')</td>
            <td style="text-align: left;">행 전체가 결측값인 행만 삭제</td>
        </tr>
        <tr>
            <td style="text-align: left;">데이터명.dropna(thresh=2)</td>
            <td style="text-align: left;">결측치의 갯수 수치를 지정해서 임계치를 넘어가면 삭제 ex)3개 결측치있으면 삭제</td>
        </tr>
        <tr>
            <td style="text-align: left;">데이터명.dropna(subset=['컬럼명1', '컬럼명2'])</td>
            <td style="text-align: left;">특정 컬럼 내의 결측치만 삭제</td>
        </tr>
        <tr>
            <td style="text-align: left;">데이터명.dropna(inplace=True)</td>
            <td style="text-align: left;">결측치 제거한 상태를 바로 적용</td>
        </tr>
    </table>
</div>

### 결측치 대치법
* 해당 변수 값들을 특정 값으로 대치함
<div style="font-weight: bold; font-size: 120%; margin-left:30px"> 
    <table align="left" margin:50 font-size: 120%>
        <tr>
            <td style="text-align: left;">데이터명.fillna(0)</td>
            <td style="text-align: left;">결측값을 0으로 대체</td>
        </tr>
        <tr>
            <td style="text-align: left;">데이터명.fillna(method='ffill 또는 'pad')</td>
            <td style="text-align: left;">결측값을 앞방향으로 채워나감</td>
        </tr>
        <tr>
            <td style="text-align: left;">데이터명.fillna(method='bfill' 또는 'backfill')</td>
            <td style="text-align: left;">결측값을 뒷 방향으로 채워나감</td>
        </tr>
        <tr>
            <td style="text-align: left;">데이터명.fillna(method='ffill', limit=1)</td>
            <td style="text-align: left;">앞/뒤 방향으로 결측값을 채우는 횟수를 1번으로 제한</td>
        </tr>
        <tr>
            <td style="text-align: left;">데이터명.fillna(데이터명.mean())</td>
            <td style="text-align: left;">결측값을 변수별 평균으로 대체</td>
        </tr>
        <tr>
            <td style="text-align: left;">데이터명.dropna(inplace=True)</td>
            <td style="text-align: left;">결측치 제거한 상태를 바로 적용</td>
        </tr>
        <tr>
            <td style="text-align: left;">데이터명.fillna(데이터명.median())</td>
            <td style="text-align: left;">결측치를 중앙값으로 대체</td>
        </tr>
        <tr>
            <td style="text-align: left;">데이터명['컬럼명'].describe()['top']</td>
            <td style="text-align: left;">범주형 변수 열의 최빈값으로 결측치를 대체</td>
        </tr>
    </table>
</div>

##  ex)결측값을 변수별 평균으로 대체;데이터명.fillna(데이터명.mean())


```python
air['Ozone'].mean()
```




    42.12931034482759




```python
air['Ozone'].fillna(air['Ozone'].mean())
# inplace True는 안해서 실제 값에는 안들어간 상태 
```




    0      41.00000
    1      36.00000
    2      12.00000
    3      18.00000
    4      42.12931
             ...   
    148    30.00000
    149    42.12931
    150    14.00000
    151    18.00000
    152    20.00000
    Name: Ozone, Length: 153, dtype: float64




```python
air_test=air
air_test['Ozone']=air_test['Ozone'].fillna(air_test['Ozone'].mean())
air_test
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ozone</th>
      <th>Solar.R</th>
      <th>Wind</th>
      <th>Temp</th>
      <th>Month</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>41.00000</td>
      <td>190.0</td>
      <td>7.4</td>
      <td>67</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36.00000</td>
      <td>118.0</td>
      <td>8.0</td>
      <td>72</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12.00000</td>
      <td>149.0</td>
      <td>12.6</td>
      <td>74</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18.00000</td>
      <td>313.0</td>
      <td>11.5</td>
      <td>62</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42.12931</td>
      <td>NaN</td>
      <td>14.3</td>
      <td>56</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>148</th>
      <td>30.00000</td>
      <td>193.0</td>
      <td>6.9</td>
      <td>70</td>
      <td>9</td>
      <td>26</td>
    </tr>
    <tr>
      <th>149</th>
      <td>42.12931</td>
      <td>145.0</td>
      <td>13.2</td>
      <td>77</td>
      <td>9</td>
      <td>27</td>
    </tr>
    <tr>
      <th>150</th>
      <td>14.00000</td>
      <td>191.0</td>
      <td>14.3</td>
      <td>75</td>
      <td>9</td>
      <td>28</td>
    </tr>
    <tr>
      <th>151</th>
      <td>18.00000</td>
      <td>131.0</td>
      <td>8.0</td>
      <td>76</td>
      <td>9</td>
      <td>29</td>
    </tr>
    <tr>
      <th>152</th>
      <td>20.00000</td>
      <td>223.0</td>
      <td>11.5</td>
      <td>68</td>
      <td>9</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
<p>153 rows × 6 columns</p>
</div>




```python
air
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ozone</th>
      <th>Solar.R</th>
      <th>Wind</th>
      <th>Temp</th>
      <th>Month</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>41.00000</td>
      <td>190.0</td>
      <td>7.4</td>
      <td>67</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36.00000</td>
      <td>118.0</td>
      <td>8.0</td>
      <td>72</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12.00000</td>
      <td>149.0</td>
      <td>12.6</td>
      <td>74</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18.00000</td>
      <td>313.0</td>
      <td>11.5</td>
      <td>62</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42.12931</td>
      <td>NaN</td>
      <td>14.3</td>
      <td>56</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>148</th>
      <td>30.00000</td>
      <td>193.0</td>
      <td>6.9</td>
      <td>70</td>
      <td>9</td>
      <td>26</td>
    </tr>
    <tr>
      <th>149</th>
      <td>42.12931</td>
      <td>145.0</td>
      <td>13.2</td>
      <td>77</td>
      <td>9</td>
      <td>27</td>
    </tr>
    <tr>
      <th>150</th>
      <td>14.00000</td>
      <td>191.0</td>
      <td>14.3</td>
      <td>75</td>
      <td>9</td>
      <td>28</td>
    </tr>
    <tr>
      <th>151</th>
      <td>18.00000</td>
      <td>131.0</td>
      <td>8.0</td>
      <td>76</td>
      <td>9</td>
      <td>29</td>
    </tr>
    <tr>
      <th>152</th>
      <td>20.00000</td>
      <td>223.0</td>
      <td>11.5</td>
      <td>68</td>
      <td>9</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
<p>153 rows × 6 columns</p>
</div>



## 사이킷런을 활용한 결측치 대치 KNN

가장 가까운 데이터를 가지고 평균값으로 대체하고 예측 


```python
from sklearn.impute import KNNImputer
```


```python
air=pd.read_csv('D:/anaconda/00.studying/data/airquality.csv')
```


```python
# 몇개의 값으로 할건지 
imputer=KNNImputer(n_neighbors=2)
```


```python
air.head()

# 4번째를 보면 NaN로 결측치이다 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ozone</th>
      <th>Solar.R</th>
      <th>Wind</th>
      <th>Temp</th>
      <th>Month</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>41.0</td>
      <td>190.0</td>
      <td>7.4</td>
      <td>67</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36.0</td>
      <td>118.0</td>
      <td>8.0</td>
      <td>72</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12.0</td>
      <td>149.0</td>
      <td>12.6</td>
      <td>74</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18.0</td>
      <td>313.0</td>
      <td>11.5</td>
      <td>62</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.3</td>
      <td>56</td>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>




```python
air_filled=imputer.fit_transform(air)
air_filled

#  네번째를 보면 주위 값들로 결측치를 채워줌 
# 18.5, 206. ,  14.3,  56. ,   5. ,   5. 
```




    array([[ 41. , 190. ,   7.4,  67. ,   5. ,   1. ],
           [ 36. , 118. ,   8. ,  72. ,   5. ,   2. ],
           [ 12. , 149. ,  12.6,  74. ,   5. ,   3. ],
           [ 18. , 313. ,  11.5,  62. ,   5. ,   4. ],
           [ 18.5, 206. ,  14.3,  56. ,   5. ,   5. ],
           [ 28. , 270.5,  14.9,  66. ,   5. ,   6. ],
           [ 23. , 299. ,   8.6,  65. ,   5. ,   7. ],
           [ 19. ,  99. ,  13.8,  59. ,   5. ,   8. ],
           [  8. ,  19. ,  20.1,  61. ,   5. ,   9. ],
           [ 17.5, 194. ,   8.6,  69. ,   5. ,  10. ],
           [  7. , 109. ,   6.9,  74. ,   5. ,  11. ],
           [ 16. , 256. ,   9.7,  69. ,   5. ,  12. ],
           [ 11. , 290. ,   9.2,  66. ,   5. ,  13. ],
           [ 14. , 274. ,  10.9,  68. ,   5. ,  14. ],
           [ 18. ,  65. ,  13.2,  58. ,   5. ,  15. ],
           [ 14. , 334. ,  11.5,  64. ,   5. ,  16. ],
           [ 34. , 307. ,  12. ,  66. ,   5. ,  17. ],
           [  6. ,  78. ,  18.4,  57. ,   5. ,  18. ],
           [ 30. , 322. ,  11.5,  68. ,   5. ,  19. ],
           [ 11. ,  44. ,   9.7,  62. ,   5. ,  20. ],
           [  1. ,   8. ,   9.7,  59. ,   5. ,  21. ],
           [ 11. , 320. ,  16.6,  73. ,   5. ,  22. ],
           [  4. ,  25. ,   9.7,  61. ,   5. ,  23. ],
           [ 32. ,  92. ,  12. ,  61. ,   5. ,  24. ],
           [ 12. ,  66. ,  16.6,  57. ,   5. ,  25. ],
           [ 12. , 266. ,  14.9,  58. ,   5. ,  26. ],
           [ 18. ,  58.5,   8. ,  57. ,   5. ,  27. ],
           [ 23. ,  13. ,  12. ,  67. ,   5. ,  28. ],
           [ 45. , 252. ,  14.9,  81. ,   5. ,  29. ],
           [115. , 223. ,   5.7,  79. ,   5. ,  30. ],
           [ 37. , 279. ,   7.4,  76. ,   5. ,  31. ],
           [ 56.5, 286. ,   8.6,  78. ,   6. ,   1. ],
           [ 17.5, 287. ,   9.7,  74. ,   6. ,   2. ],
           [ 17.5, 242. ,  16.1,  67. ,   6. ,   3. ],
           [ 56.5, 186. ,   9.2,  84. ,   6. ,   4. ],
           [ 56.5, 220. ,   8.6,  85. ,   6. ,   5. ],
           [ 15.5, 264. ,  14.3,  79. ,   6. ,   6. ],
           [ 29. , 127. ,   9.7,  82. ,   6. ,   7. ],
           [ 71.5, 273. ,   6.9,  87. ,   6. ,   8. ],
           [ 71. , 291. ,  13.8,  90. ,   6. ,   9. ],
           [ 39. , 323. ,  11.5,  87. ,   6. ,  10. ],
           [109.5, 259. ,  10.9,  93. ,   6. ,  11. ],
           [ 94. , 250. ,   9.2,  92. ,   6. ,  12. ],
           [ 23. , 148. ,   8. ,  82. ,   6. ,  13. ],
           [ 23. , 332. ,  13.8,  80. ,   6. ,  14. ],
           [ 23. , 322. ,  11.5,  79. ,   6. ,  15. ],
           [ 21. , 191. ,  14.9,  77. ,   6. ,  16. ],
           [ 37. , 284. ,  20.7,  72. ,   6. ,  17. ],
           [ 20. ,  37. ,   9.2,  65. ,   6. ,  18. ],
           [ 12. , 120. ,  11.5,  73. ,   6. ,  19. ],
           [ 13. , 137. ,  10.3,  76. ,   6. ,  20. ],
           [ 44. , 150. ,   6.3,  77. ,   6. ,  21. ],
           [ 33. ,  59. ,   1.7,  76. ,   6. ,  22. ],
           [ 13.5,  91. ,   4.6,  76. ,   6. ,  23. ],
           [ 47.5, 250. ,   6.3,  76. ,   6. ,  24. ],
           [ 15.5, 135. ,   8. ,  75. ,   6. ,  25. ],
           [ 15. , 127. ,   8. ,  78. ,   6. ,  26. ],
           [  8. ,  47. ,  10.3,  73. ,   6. ,  27. ],
           [ 36. ,  98. ,  11.5,  80. ,   6. ,  28. ],
           [ 11. ,  31. ,  14.9,  77. ,   6. ,  29. ],
           [ 27. , 138. ,   8. ,  83. ,   6. ,  30. ],
           [135. , 269. ,   4.1,  84. ,   7. ,   1. ],
           [ 49. , 248. ,   9.2,  85. ,   7. ,   2. ],
           [ 32. , 236. ,   9.2,  81. ,   7. ,   3. ],
           [ 56.5, 101. ,  10.9,  84. ,   7. ,   4. ],
           [ 64. , 175. ,   4.6,  83. ,   7. ,   5. ],
           [ 40. , 314. ,  10.9,  83. ,   7. ,   6. ],
           [ 77. , 276. ,   5.1,  88. ,   7. ,   7. ],
           [ 97. , 267. ,   6.3,  92. ,   7. ,   8. ],
           [ 97. , 272. ,   5.7,  92. ,   7. ,   9. ],
           [ 85. , 175. ,   7.4,  89. ,   7. ,  10. ],
           [ 50.5, 139. ,   8.6,  82. ,   7. ,  11. ],
           [ 10. , 264. ,  14.3,  73. ,   7. ,  12. ],
           [ 27. , 175. ,  14.9,  81. ,   7. ,  13. ],
           [ 75.5, 291. ,  14.9,  91. ,   7. ,  14. ],
           [  7. ,  48. ,  14.3,  80. ,   7. ,  15. ],
           [ 48. , 260. ,   6.9,  81. ,   7. ,  16. ],
           [ 35. , 274. ,  10.3,  82. ,   7. ,  17. ],
           [ 61. , 285. ,   6.3,  84. ,   7. ,  18. ],
           [ 79. , 187. ,   5.1,  87. ,   7. ,  19. ],
           [ 63. , 220. ,  11.5,  85. ,   7. ,  20. ],
           [ 16. ,   7. ,   6.9,  74. ,   7. ,  21. ],
           [ 34.5, 258. ,   9.7,  81. ,   7. ,  22. ],
           [ 70.5, 295. ,  11.5,  82. ,   7. ,  23. ],
           [ 80. , 294. ,   8.6,  86. ,   7. ,  24. ],
           [108. , 223. ,   8. ,  85. ,   7. ,  25. ],
           [ 20. ,  81. ,   8.6,  82. ,   7. ,  26. ],
           [ 52. ,  82. ,  12. ,  86. ,   7. ,  27. ],
           [ 82. , 213. ,   7.4,  88. ,   7. ,  28. ],
           [ 50. , 275. ,   7.4,  86. ,   7. ,  29. ],
           [ 64. , 253. ,   7.4,  83. ,   7. ,  30. ],
           [ 59. , 254. ,   9.2,  81. ,   7. ,  31. ],
           [ 39. ,  83. ,   6.9,  81. ,   8. ,   1. ],
           [  9. ,  24. ,  13.8,  81. ,   8. ,   2. ],
           [ 16. ,  77. ,   7.4,  82. ,   8. ,   3. ],
           [ 78. , 203. ,   6.9,  86. ,   8. ,   4. ],
           [ 35. , 203. ,   7.4,  85. ,   8. ,   5. ],
           [ 66. , 224. ,   4.6,  87. ,   8. ,   6. ],
           [122. , 255. ,   4. ,  89. ,   8. ,   7. ],
           [ 89. , 229. ,  10.3,  90. ,   8. ,   8. ],
           [110. , 207. ,   8. ,  90. ,   8. ,   9. ],
           [ 77.5, 222. ,   8.6,  92. ,   8. ,  10. ],
           [ 56.5, 137. ,  11.5,  86. ,   8. ,  11. ],
           [ 44. , 192. ,  11.5,  86. ,   8. ,  12. ],
           [ 28. , 273. ,  11.5,  82. ,   8. ,  13. ],
           [ 65. , 157. ,   9.7,  80. ,   8. ,  14. ],
           [ 14.5,  64. ,  11.5,  79. ,   8. ,  15. ],
           [ 22. ,  71. ,  10.3,  77. ,   8. ,  16. ],
           [ 59. ,  51. ,   6.3,  79. ,   8. ,  17. ],
           [ 23. , 115. ,   7.4,  76. ,   8. ,  18. ],
           [ 31. , 244. ,  10.9,  78. ,   8. ,  19. ],
           [ 44. , 190. ,  10.3,  78. ,   8. ,  20. ],
           [ 21. , 259. ,  15.5,  77. ,   8. ,  21. ],
           [  9. ,  36. ,  14.3,  72. ,   8. ,  22. ],
           [ 33. , 255. ,  12.6,  75. ,   8. ,  23. ],
           [ 45. , 212. ,   9.7,  79. ,   8. ,  24. ],
           [168. , 238. ,   3.4,  81. ,   8. ,  25. ],
           [ 73. , 215. ,   8. ,  86. ,   8. ,  26. ],
           [ 44. , 153. ,   5.7,  88. ,   8. ,  27. ],
           [ 76. , 203. ,   9.7,  97. ,   8. ,  28. ],
           [118. , 225. ,   2.3,  94. ,   8. ,  29. ],
           [ 84. , 237. ,   6.3,  96. ,   8. ,  30. ],
           [ 85. , 188. ,   6.3,  94. ,   8. ,  31. ],
           [ 96. , 167. ,   6.9,  91. ,   9. ,   1. ],
           [ 78. , 197. ,   5.1,  92. ,   9. ,   2. ],
           [ 73. , 183. ,   2.8,  93. ,   9. ,   3. ],
           [ 91. , 189. ,   4.6,  93. ,   9. ,   4. ],
           [ 47. ,  95. ,   7.4,  87. ,   9. ,   5. ],
           [ 32. ,  92. ,  15.5,  84. ,   9. ,   6. ],
           [ 20. , 252. ,  10.9,  80. ,   9. ,   7. ],
           [ 23. , 220. ,  10.3,  78. ,   9. ,   8. ],
           [ 21. , 230. ,  10.9,  75. ,   9. ,   9. ],
           [ 24. , 259. ,   9.7,  73. ,   9. ,  10. ],
           [ 44. , 236. ,  14.9,  81. ,   9. ,  11. ],
           [ 21. , 259. ,  15.5,  76. ,   9. ,  12. ],
           [ 28. , 238. ,   6.3,  77. ,   9. ,  13. ],
           [  9. ,  24. ,  10.9,  71. ,   9. ,  14. ],
           [ 13. , 112. ,  11.5,  71. ,   9. ,  15. ],
           [ 46. , 237. ,   6.9,  78. ,   9. ,  16. ],
           [ 18. , 224. ,  13.8,  67. ,   9. ,  17. ],
           [ 13. ,  27. ,  10.3,  76. ,   9. ,  18. ],
           [ 24. , 238. ,  10.3,  68. ,   9. ,  19. ],
           [ 16. , 201. ,   8. ,  82. ,   9. ,  20. ],
           [ 13. , 238. ,  12.6,  64. ,   9. ,  21. ],
           [ 23. ,  14. ,   9.2,  71. ,   9. ,  22. ],
           [ 36. , 139. ,  10.3,  81. ,   9. ,  23. ],
           [  7. ,  49. ,  10.3,  69. ,   9. ,  24. ],
           [ 14. ,  20. ,  16.6,  63. ,   9. ,  25. ],
           [ 30. , 193. ,   6.9,  70. ,   9. ,  26. ],
           [ 24.5, 145. ,  13.2,  77. ,   9. ,  27. ],
           [ 14. , 191. ,  14.3,  75. ,   9. ,  28. ],
           [ 18. , 131. ,   8. ,  76. ,   9. ,  29. ],
           [ 20. , 223. ,  11.5,  68. ,   9. ,  30. ]])




```python
# 해당 자료를 데이터프레임화해서 pre_air로 저장하기 
pre_air=pd.DataFrame(air_filled,columns=air.columns)
```


```python
pre_air
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ozone</th>
      <th>Solar.R</th>
      <th>Wind</th>
      <th>Temp</th>
      <th>Month</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>41.0</td>
      <td>190.0</td>
      <td>7.4</td>
      <td>67.0</td>
      <td>5.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36.0</td>
      <td>118.0</td>
      <td>8.0</td>
      <td>72.0</td>
      <td>5.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12.0</td>
      <td>149.0</td>
      <td>12.6</td>
      <td>74.0</td>
      <td>5.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18.0</td>
      <td>313.0</td>
      <td>11.5</td>
      <td>62.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18.5</td>
      <td>206.0</td>
      <td>14.3</td>
      <td>56.0</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>148</th>
      <td>30.0</td>
      <td>193.0</td>
      <td>6.9</td>
      <td>70.0</td>
      <td>9.0</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>149</th>
      <td>24.5</td>
      <td>145.0</td>
      <td>13.2</td>
      <td>77.0</td>
      <td>9.0</td>
      <td>27.0</td>
    </tr>
    <tr>
      <th>150</th>
      <td>14.0</td>
      <td>191.0</td>
      <td>14.3</td>
      <td>75.0</td>
      <td>9.0</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>151</th>
      <td>18.0</td>
      <td>131.0</td>
      <td>8.0</td>
      <td>76.0</td>
      <td>9.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>152</th>
      <td>20.0</td>
      <td>223.0</td>
      <td>11.5</td>
      <td>68.0</td>
      <td>9.0</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
<p>153 rows × 6 columns</p>
</div>




```python
pre_air.isna().sum()
```




    Ozone      0
    Solar.R    0
    Wind       0
    Temp       0
    Month      0
    Day        0
    dtype: int64



# 이상치 인식(사분위수로 판단) 

* 데이터명.describe()
    * 결측치가 아닌 데이터행의 개수
    * 평균/표준편차
    * 최소/최댓값
    * Q1, Q2, Q3 나타내줌
* IQR을 이용한 이상치 탐색 : 함수 생성

## 이상치를 box plot으로 확인하기 


```python
import seaborn as sns

sns.boxplot(x='Ozone', data=air)
```




    <AxesSubplot:xlabel='Ozone'>




![output_35_1](https://user-images.githubusercontent.com/88616282/205916650-a6659d65-e612-49f1-a15b-252e6af87a79.png)

    


## IQR 을 이용한 이상치 탐색 함수


```python

def detect_outliers(df=None, column=None, weight=1.5):
    Q1 = df[column].quantile(0.25)
    Q3 = df[column].quantile(0.75)
    
    IQR = Q3 - Q1
    IQR_weight = IQR*weight
    
    outlier_idx = df[(df[column] < Q1 - IQR_weight) | (df[column] > Q3 + IQR_weight)].index
    
    return outlier_idx
```


```python
# IQR로 이상치를 찾아 인덱스 저장되어 있음 

out_index = detect_outliers(df=air, column='Ozone')
out_index
```




    Int64Index([61, 116], dtype='int64')




```python
air.loc[out_index,'outlier']=True
```


```python
air[air['outlier']==True]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ozone</th>
      <th>Solar.R</th>
      <th>Wind</th>
      <th>Temp</th>
      <th>Month</th>
      <th>Day</th>
      <th>outlier</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>61</th>
      <td>135.0</td>
      <td>269.0</td>
      <td>4.1</td>
      <td>84</td>
      <td>7</td>
      <td>1</td>
      <td>True</td>
    </tr>
    <tr>
      <th>116</th>
      <td>168.0</td>
      <td>238.0</td>
      <td>3.4</td>
      <td>81</td>
      <td>8</td>
      <td>25</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>




```python
# outlier 대체 (중위 값 혹은 평균값으로)
air.loc[out_index,'Ozone'] = air['Ozone'].median()
air.loc[out_index,'Ozone'] 
```




    61     31.5
    116    31.5
    Name: Ozone, dtype: float64




```python
sns.boxplot(x='Ozone', data=air)
# 또 이상치가 있음
```




    <AxesSubplot:xlabel='Ozone'>




![output_42_1](https://user-images.githubusercontent.com/88616282/205916700-a255d9c3-c69e-4670-b0c0-f4fbc53ce59f.png)




```python
# 이상치 정보 
out_index = detect_outliers(df=air, column='Ozone')
out_index
```




    Int64Index([98], dtype='int64')




```python
# outlier 제거
air_2 = air.drop(out_index).reset_index(drop=True)
```


```python
air_2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ozone</th>
      <th>Solar.R</th>
      <th>Wind</th>
      <th>Temp</th>
      <th>Month</th>
      <th>Day</th>
      <th>outlier</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>41.0</td>
      <td>190.0</td>
      <td>7.4</td>
      <td>67</td>
      <td>5</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36.0</td>
      <td>118.0</td>
      <td>8.0</td>
      <td>72</td>
      <td>5</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12.0</td>
      <td>149.0</td>
      <td>12.6</td>
      <td>74</td>
      <td>5</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18.0</td>
      <td>313.0</td>
      <td>11.5</td>
      <td>62</td>
      <td>5</td>
      <td>4</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.3</td>
      <td>56</td>
      <td>5</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>147</th>
      <td>30.0</td>
      <td>193.0</td>
      <td>6.9</td>
      <td>70</td>
      <td>9</td>
      <td>26</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>148</th>
      <td>NaN</td>
      <td>145.0</td>
      <td>13.2</td>
      <td>77</td>
      <td>9</td>
      <td>27</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>149</th>
      <td>14.0</td>
      <td>191.0</td>
      <td>14.3</td>
      <td>75</td>
      <td>9</td>
      <td>28</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>150</th>
      <td>18.0</td>
      <td>131.0</td>
      <td>8.0</td>
      <td>76</td>
      <td>9</td>
      <td>29</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>151</th>
      <td>20.0</td>
      <td>223.0</td>
      <td>11.5</td>
      <td>68</td>
      <td>9</td>
      <td>30</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>152 rows × 7 columns</p>
</div>




```python
sns.boxplot(x='Ozone', data=air_2)
```




    <AxesSubplot:xlabel='Ozone'>




 
![output_46_1](https://user-images.githubusercontent.com/88616282/205916768-e969bb46-fce7-45e4-97af-e98be4bb4f60.png)


